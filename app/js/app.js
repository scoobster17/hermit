'use strict';var template='<webview id="{{ id }}-webview" src="{{ url }}" ></webview>',buttonTemplate='<button data-name="{{ name }}" data-site="{{ site }}" data-url="{{ url }}" >{{ name }}<img src="img/service/{{ name | lowercase }}/{{ logo }}" alt="" /></button>',createTabContent=function(a){var b=template.replace(/\{\{ ?([a-zA-Z]+) ?\}\}/g,function(){return''+a[arguments[1]]});return b},createButton=function(a){var b=buttonTemplate.replace(/\{\{ ?([a-zA-Z]+)( ?\| ?([a-zA-Z]+))? ?\}\}/g,function(){var b=arguments[1],c=arguments[3];if(c!==void 0)switch(c){case'lowercase':return''+a[b].toLowerCase();break;default:return''+a[b];}else return''+a[b]});return b},tabContentContainer=document.getElementById('tab-content-container'),preconfiguredTabs=document.getElementById('pre-configured-tabs'),getPreconfiguredTabs=function(){fetch('/pre-configured-tabs').then(function(a){if(a.ok)return a;throw new Error('There was an error')}).then(function(a){return a.json()}).then(function(a){a.forEach(function(a){preconfiguredTabs.innerHTML+='<li>'+createButton(a)+'</li>'});var b=document.getElementById('add-new-site'),c=preconfiguredTabs.getElementsByTagName('button'),d=!0,e=!1,f=void 0;try{for(var g,h,i=c[Symbol.iterator]();!(d=(g=i.next()).done);d=!0){h=g.value,h.addEventListener('click',function(a){for(var c in a.target.dataset){var d=document.getElementById(c);d&&(d.value=a.target.dataset[c])}b.scrollIntoView()});var j=h.querySelector('img');j&&h.addEventListener('click',function(a){a.target.parentElement.click()})}}catch(a){e=!0,f=a}finally{try{!d&&i.return&&i.return()}finally{if(e)throw f}}})},tabList=document.getElementById('hermit-nav'),bindTabTriggers=function(){var a=tabList.querySelectorAll('a'),b=tabContentContainer.querySelectorAll('.tab');a.forEach(function(c){c.addEventListener('click',function(c){c.preventDefault(),a.forEach(function(a){a.removeAttribute('aria-selected')}),c.target.setAttribute('aria-selected','true');var d=document.getElementById(c.target.getAttribute('href').slice(1));b.forEach(function(a){a.setAttribute('aria-hidden','true')}),d.removeAttribute('aria-hidden')})})},serializeForm=function(a){var b={},c=a.querySelectorAll('input[type="text"]');return c.forEach(function(a){b[a.name]=a.value}),b},getUserTabs=function(){fetch('/user/settings/get').then(function(a){if(a.ok)return a;throw new Error('There was an error')}).then(function(a){return a.json()}).then(function(a){var b=JSON.parse(a.data);b&&b.forEach(function(a){createTab(a,!1),bindTabTriggers()})})},createTab=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!0;tabContentContainer.innerHTML+='<div id="'+a.id+'" class="tab" role="tabpanel" aria-labelledby="tab-'+a.name+'" '+(b?'':'aria-hidden="true" ')+'>'+createTabContent({id:a.id,url:a.url})+'</div>',tabList.innerHTML+=['<li>','<a href="#'+a.id+'" id="tab-'+a.name+'" role="tab" aria-controls="'+a.id+'" '+(b?'aria-selected="true" ':'')+'>',a.name,'</a>','</li>'].join('')},init=function(){getPreconfiguredTabs(),getUserTabs();var a=document.getElementById('new-tab-form');a.addEventListener('submit',function(a){a.preventDefault();var b=serializeForm(a.target);b.id='hermit-'+new Date().getTime(),fetch('/user/settings/set',{method:'POST',headers:{"Content-Type":'application/json'},body:JSON.stringify(b)}).then(function(a){if(a.ok)return a;throw new Error('There was an error')}).then(function(a){console.log(a)});var c=tabContentContainer.querySelectorAll('.tab');c.forEach(function(a){a.setAttribute('aria-hidden','true')});var d=tabList.querySelectorAll('a');return d.forEach(function(a){a.removeAttribute('aria-selected')}),createTab(b),bindTabTriggers(),!1})};window.addEventListener('load',init);